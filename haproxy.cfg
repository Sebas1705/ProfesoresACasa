global
	maxconn 100

listen stats
    mode http
    bind *:8080
    stats enable
    stats hide-version
    stats refresh 30s
    stats show-node
    stats uri /admin?stats
    
frontend myfrontend
	bind :443
	# We specify a level 4 load balancing (tcp)
	mode tcp
	option tcplog
	tcp-request content accept if { req_ssl_hello_type 1 }
	default_backend mybackend

backend mybackend
	# We specify a level 4 load balancing (tcp)
	mode tcp
	option log-health-checks
	# A server that uses ssl (https). The "verify none" directive is used
	# to avoid checking the validity of the certificate (which would fail as
	# it is a self-signed certificate)
	server w1 web-1:8443 check verify none
	server w2 web-2:8443 check verify none

frontend restfrontend
	bind :8080
	mode http
	default_backend rest

backend rest
	mode http
	option log-health-checks
	server s1 service-1:8080 check
	server s2 service-2:8080 check